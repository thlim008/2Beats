{% extends "base.html" %}

{% block content %}
<div class="tb-upload-first">
  <h1 class="tb-page-title">Upload your audio files.</h1>
  <p class="tb-page-subtitle">
    For best quality, use WAV, FLAC, AIFF, or ALAC.
  </p>

  <form method="post" enctype="multipart/form-data" class="tb-upload-drop-form">
    {% csrf_token %}

    {% if form.music_root.errors %}
      <div class="tb-form-errors">
        {{ form.music_root.errors }}
      </div>
    {% endif %}

    <div class="tb-upload-dropwrap">
    <div class="tb-upload-dropzone"
         onclick="document.getElementById('id_music_root').click()">
      <div class="tb-upload-drop-inner">
        <div class="tb-upload-text-main">
          Drag and drop audio files to get started.
        </div>
        <button type="button" class="tb-upload-drop-btn">
          Choose files
        </button>
        <div class="tb-upload-text-sub">
          Or click to browse from your device.
        </div>
      </div>
    </div>
    </div>

    {{ form.music_root }}

  </form>
</div>

<script>
  // 파일 input 숨겨두고, 선택 시 자동 제출
  const fileInput = document.getElementById('id_music_root');
  if (fileInput) {
    fileInput.style.display = 'none';

    fileInput.addEventListener('change', function () {
      if (this.files.length > 0) {
        this.form.submit();
      }
    });
  }
</script>
{% endblock %}
