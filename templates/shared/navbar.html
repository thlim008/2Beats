<!--
  ========================================
  공유 네비게이션 바 (Shared Navbar)
  ========================================
  - 모든 페이지에서 공통으로 사용되는 상단 네비게이션 바
  - 글래스모피즘(glassmorphism) 효과로 현대적인 느낌 구현
  - 반응형 디자인으로 모바일/데스크톱 모두 지원
  - 로그인 상태에 따라 다른 메뉴 표시
-->

<style>
    /* ========================================
       전역 body 스타일
       ======================================== */
    body {
        padding-top: 80px; /* navbar가 fixed이므로 body에 padding을 줘서 컨텐츠가 가려지지 않도록 함 */
    }

    /* ========================================
       메인 네비게이션 바 스타일
       ======================================== */
    .shared-navbar {
        /* 글래스모피즘 효과 - 반투명 배경 + 블러 */
        background: rgba(0,0,0,0.3);  /* 30% 불투명도의 검은색 배경 */
        backdrop-filter: blur(12px);   /* 배경 블러 효과 (표준) */
        -webkit-backdrop-filter: blur(12px);  /* Safari 지원용 */

        /* 하단 구분선 */
        border-bottom: 1px solid rgba(255,255,255,0.1);  /* 미세한 흰색 테두리 */

        /* 화면 상단 고정 */
        position: fixed;
        top: 0; left: 0; right: 0;
        z-index: 1000;  /* 다른 요소들 위에 표시 */

        /* 한국어 폰트 설정 */
        font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    /* ========================================
       네비게이션 컨테이너 - 중앙 정렬 및 최대 너비 제한
       ======================================== */
    .navbar-container {
        max-width: 1200px;  /* 최대 너비 제한 */
        margin: 0 auto;     /* 중앙 정렬 */
        padding: 1rem 2rem; /* 내부 여백 */
    }

    /* ========================================
       상단 영역 - 로고, 검색, 액션 버튼
       ======================================== */
    .navbar-top {
        display: flex;              /* flexbox 레이아웃 */
        align-items: center;        /* 수직 중앙 정렬 */
        justify-content: space-between;  /* 양 끝으로 분산 */
        gap: 2rem;                  /* 요소 간 간격 */
    }

    /* ========================================
       로고 스타일
       ======================================== */
    .navbar-logo {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;               /* 아이콘과 텍스트 사이 간격 */
        font-size: 1.5rem;         /* 큰 글씨 크기 */
        font-weight: 700;          /* 굵은 폰트 */
        color: #ffffff !important; /* 흰색 (중요도 높음) */
        letter-spacing: -0.5px;    /* 글자 간격 좁게 */
        text-decoration: none;     /* 밑줄 제거 */
    }
    .navbar-logo:hover {
        color: #ffffff !important; /* 호버 시에도 색상 유지 */
    }

    /* 로고 박스 - 2B 아이콘 */
    .logo-box {
        width: 40px;
        height: 40px;
        border-radius: 10px;       /* 둥근 모서리 */
        /* 보라색 그라데이션 배경 */
        background: linear-gradient(135deg, #c084fc 0%, #7c3aed 100%);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 700;
        font-size: 18px;
        /* 그림자 효과로 입체감 추가 */
        box-shadow: 0 4px 12px rgba(124,58,237,0.4);
    }

    /* ========================================
       검색바 스타일
       ======================================== */
    .navbar-search {
        flex: 1;                   /* 남은 공간 모두 차지 */
        max-width: 500px;          /* 최대 너비 제한 */
        position: relative;        /* 아이콘 절대 위치 기준점 */
    }

    .navbar-search input {
        width: 100%;
        padding: 10px 40px 10px 16px;  /* 오른쪽에 아이콘 공간 확보 */
        /* 반투명 배경 */
        background: rgba(255,255,255,0.1);
        border: 1px solid rgba(255,255,255,0.2);
        border-radius: 24px;       /* 완전히 둥근 모서리 */
        color: white;
        font-size: 14px;
        transition: all 0.2s;      /* 부드러운 전환 효과 */
    }

    .navbar-search input::placeholder {
        color: rgba(255,255,255,0.5);  /* 플레이스홀더는 더 투명하게 */
    }

    /* 포커스 시 스타일 */
    .navbar-search input:focus {
        outline: none;
        background: rgba(255,255,255,0.15);  /* 살짝 더 밝게 */
        border-color: #c084fc;               /* 보라색 테두리 */
    }

    /* 검색 아이콘 - 입력창 오른쪽에 위치 */
    .navbar-search-icon {
        position: absolute;
        right: 14px;
        top: 50%;
        transform: translateY(-50%);  /* 수직 중앙 정렬 */
        color: rgba(255,255,255,0.5);
    }

    /* ========================================
       액션 버튼 영역 (업로드, 유저, 로그아웃 등)
       ======================================== */
    .navbar-actions {
        display: flex;
        align-items: center;
        gap: 1rem;  /* 버튼 간 간격 */
    }

    /* 아이콘 버튼 (로그아웃 등) */
    .navbar-icon-btn {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: rgba(255,255,255,0.8);
        transition: all 0.2s;
        border-radius: 50%;        /* 원형 */
        text-decoration: none;
    }

    .navbar-icon-btn:hover {
        color: white;
        background: rgba(255,255,255,0.1);  /* 호버 시 배경 */
    }

    /* 업로드 버튼 - 그라데이션 배경 */
    .navbar-upload-btn {
        display: inline-flex;
        align-items: center;
        gap: 6px;  /* 아이콘과 텍스트 간격 */
        padding: 10px 20px;
        /* 보라색 그라데이션 */
        background: linear-gradient(120deg, #c084fc, #7c3aed);
        color: white;
        border-radius: 24px;  /* 완전히 둥근 버튼 */
        font-weight: 600;
        font-size: 14px;
        text-decoration: none;
        transition: opacity 0.2s;
    }

    .navbar-upload-btn:hover {
        opacity: 0.9;  /* 호버 시 살짝 투명하게 */
    }

    /* 유저 정보 버튼 (아바타 + 이름) */
    .navbar-user {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: white;
        text-decoration: none;
        padding: 6px 12px;
        border-radius: 24px;
        transition: background 0.2s;
    }

    .navbar-user:hover {
        background: rgba(255,255,255,0.1);  /* 호버 시 배경 */
    }

    /* 유저 아바타 - 원형 그라데이션 배경에 이니셜 표시 */
    .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;  /* 원형 */
        /* 보라색-파란색 그라데이션 */
        background: linear-gradient(135deg, #7c3aed 0%, #1d4ed8 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.85rem;
    }

    /* 로그인 버튼 */
    .navbar-login-btn {
        padding: 10px 24px;
        /* 보라색 그라데이션 */
        background: linear-gradient(120deg, #7c3aed, #c084fc);
        color: white;
        border-radius: 24px;
        font-weight: 600;
        font-size: 14px;
        text-decoration: none;
        transition: opacity 0.2s;
    }

    .navbar-login-btn:hover {
        opacity: 0.9;
    }

    /* ========================================
       하단 메뉴 영역 (음악 검색, 차트, 영상 등)
       ======================================== */
    .navbar-menu {
        display: flex;
        gap: 2rem;  /* 메뉴 항목 간 간격 */
        align-items: center;
        margin-top: 1rem;
        padding-top: 1rem;
        /* 상단 구분선 */
        border-top: 1px solid rgba(255,255,255,0.05);
    }

    .navbar-menu a {
        color: rgba(255,255,255,0.8);
        text-decoration: none;
        font-weight: 500;
        font-size: 0.9rem;
        transition: color 0.2s;
    }

    .navbar-menu a:hover {
        color: #c084fc;  /* 호버 시 보라색 */
    }

    /* ========================================
       모바일 반응형 스타일 (768px 이하)
       ======================================== */
    @media (max-width: 768px) {
        body {
            padding-top: 140px;  /* 모바일에서는 navbar가 2줄이므로 더 큰 padding */
        }

        .navbar-container {
            padding: 0.75rem 1rem;  /* 모바일에서는 padding 줄임 */
        }

        .navbar-top {
            flex-wrap: wrap;  /* 모바일에서는 줄바꿈 허용 */
        }

        /* 검색바를 3번째 순서로 이동하고 전체 너비 사용 */
        .navbar-search {
            order: 3;
            width: 100%;
            max-width: 100%;
            margin-top: 0.75rem;
        }

        /* 업로드 버튼에서 텍스트 숨김 (아이콘만 표시) */
        .navbar-upload-btn span {
            display: none;
        }

        /* 메뉴 간격 줄이고 가로 스크롤 허용 */
        .navbar-menu {
            gap: 1rem;
            overflow-x: auto;  /* 가로 스크롤 */
        }

        .navbar-menu a {
            font-size: 0.85rem;
            white-space: nowrap;  /* 텍스트 줄바꿈 방지 */
        }

        /* 유저 이름 숨김 (아바타만 표시) */
        .navbar-user span {
            display: none;
        }
    }
</style>

<!-- ========================================
     네비게이션 바 HTML 구조
     ======================================== -->
<nav class="shared-navbar">
    <div class="navbar-container">
        <!-- 상단 영역: 로고 + 검색 + 액션 -->
        <div class="navbar-top">
            <!-- 로고: 로그인 여부에 따라 다른 페이지로 이동 -->
            <a href="{% if user.is_authenticated %}{% url 'home' %}{% else %}{% url 'landing' %}{% endif %}" class="navbar-logo">
                <div class="logo-box">2B</div>
                <span>2BEATS</span>
            </a>

            <!-- 검색바: 음악 검색 페이지로 연결 -->
            <div class="navbar-search">
                <form action="{% url 'music_explore:search' %}" method="get">
                    <input type="text" name="q" placeholder="아티스트, 트랙, 장르 검색..." />
                    <!-- 검색 아이콘 (SVG) -->
                    <svg class="navbar-search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </form>
            </div>

            <!-- 액션 버튼들: 로그인 상태에 따라 다른 버튼 표시 -->
            <div class="navbar-actions">
                {% if user.is_authenticated %}
                    <!-- 로그인 상태: 업로드, 프로필, 로그아웃 버튼 -->

                    <!-- 음악 업로드 버튼 -->
                    <a href="{% url 'twobeats_upload:music_upload_start' %}" class="navbar-upload-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        <span>음악</span>
                    </a>

                    <!-- 영상 업로드 버튼 -->
                    <a href="{% url 'twobeats_upload:video_upload_start' %}" class="navbar-upload-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        <span>영상</span>
                    </a>

                    <!-- 유저 프로필 버튼 (아바타 + 이름) -->
                    <a href="{% url 'profile' %}" class="navbar-user">
                        <!-- 유저 이름의 첫 글자를 대문자로 표시 -->
                        <div class="user-avatar">{{ user.username|slice:":1"|upper }}</div>
                        <span>{{ user.username }}</span>
                    </a>

                    <!-- 로그아웃 버튼 -->
                    <a href="{% url 'logout' %}" class="navbar-icon-btn" title="로그아웃">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                            <polyline points="16 17 21 12 16 7"></polyline>
                            <line x1="21" y1="12" x2="9" y2="12"></line>
                        </svg>
                    </a>
                {% else %}
                    <!-- 비로그인 상태: 로그인 버튼만 표시 -->
                    <a href="{% url 'login' %}" class="navbar-login-btn">로그인</a>
                {% endif %}
            </div>
        </div>

        <!-- 하단 메뉴: 주요 페이지 링크 -->
        <div class="navbar-menu">
            <a href="{% url 'music_explore:search' %}">음악 검색</a>
            <a href="{% url 'music_explore:chart_all' %}">차트</a>
            <a href="{% url 'video_explore:video_list' %}">영상</a>
            <a href="{% url 'twobeats_worldcup:play' %}">월드컵</a>

            <!-- 로그인 상태에서만 표시되는 메뉴 -->
            {% if user.is_authenticated %}
                <a href="{% url 'mylist' %}">플레이리스트</a>
                <a href="{% url 'history' %}">히스토리</a>
            {% endif %}
        </div>
    </div>
</nav>
